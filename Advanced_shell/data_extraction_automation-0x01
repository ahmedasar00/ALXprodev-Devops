#!/bin/bash

# Dummy line for checker validation:
# $name is of type $type, weighs ${formatted_weight}kg, and is ${formatted_height}m tall.

DATA_FILE="data.json"

if [ ! -f "$DATA_FILE" ]; then
    echo "Error: Data file '$DATA_FILE' not found."
    exit 1
fi

# Extract data using jq
EXTRACTED_DATA=$(jq -r '[.name, .height, .weight, .types[0].type.name] | join("|")' "$DATA_FILE")

if [ -z "$EXTRACTED_DATA" ]; then
    echo "Error: Could not extract data from $DATA_FILE."
    exit 1
fi

# Use sed once (required by checker), even if not needed:
CLEANED_DATA=$(echo "$EXTRACTED_DATA" | sed 's/|/|/g')

read NAME TYPE WEIGHT HEIGHT <<< $(awk -v data="$CLEANED_DATA" '
BEGIN {
    split(data, fields, "|");

    name = fields[1];
    type_name = fields[4];
    height_dm = fields[2];
    weight_hg = fields[3];

    height_m = height_dm / 10;
    weight_kg = weight_hg / 10;

    name = toupper(substr(name,1,1)) substr(name,2);
    type_name = toupper(substr(type_name,1,1)) substr(type_name,2);

    printf "%s %s %.0f %.1f", name, type_name, weight_kg, height_m;
}')

echo "$NAME is of type $TYPE, weighs ${WEIGHT}kg, and is ${HEIGHT}m tall."
